### Projects, Applications

In Django,
* Project: is a Django installation with settings. A project is considered as the website and it constitutes applications which can be reused in other projects. For example, a document management site could contain applications like documents, feedback etc. The feedback application can be used in other projects like blogs, albums etc.
* Application: is a collection of models, views, templates and URLs. Applications extend and customize the framework extension points to provide specific functionalities. 

### Creating the project

Activate the virtual environment 

> $ droid@droidserver:~/onGit/Django$ source /home/droid/scratchpad/Django/vir_env/bin/activate

    (vir_env) droid@droidserver:~/onGit/Django$ django-admin startproject documents-site

Create the project

> (vir_env) droid@droidserver:~/onGit/Django$ django-admin startproject documents-site

    CommandError: 'documents-site' is not a valid project name. Please use only numbers, letters and underscores.

> (vir_env) droid@droidserver:~/onGit/Django$ django-admin startproject documentsite

> (vir_env) droid@droidserver:~/onGit/Django$ ls documentsite/
  
    documentsite  manage.py  README.md

### Project Structure
  
<img src="https://github.com/gruprog/Django-Examples/blob/master/documentsite/_misc/app%20structure.png"/>

<b> Generated Files </b>

<i>documentsite/documentsite/</i>: is the project directory

    __init__.py: An empty file that tells Python to treat "documentsite" directory as a Python module.
    settings.py: holds settings and configuration of the project. It is initialized with default settings. By default, it is configured to use a SQLite database and a list of Django applications.
    urls.py: holds URL patterns. Each URL pattern is mapped to a view.
    wsgi.py: contains configuration to run the project as a WSGI application
    
<i>documentsite/manage.py</i>: is a wrapper around the django-admin.py tool. It is offered as a command line utiltiy to interact with the project.

### Create the tables in the database

<i>documentsite/documentsite/settings.py</i>

The settings.py file, by default, is configured to use a SQLite database and a list of Django applications. 

All settings and their default values can be found at: 
https://docs.djangoproject.com/en/1.9/topics/settings/

```python
"""
Django settings for documentsite project.

Generated by 'django-admin startproject' using Django 1.9.2.

For more information on this file, see
https://docs.djangoproject.com/en/1.9/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/1.9/ref/settings/
"""

import os

# Build paths inside the project like this: os.path.join(BASE_DIR, ...)
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/1.9/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'fv)tjpx+rl63jtr0x@$o=vcx+-o+($ppluld^=&z(^s*6qi6s_'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]

MIDDLEWARE_CLASSES = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.auth.middleware.SessionAuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'documentsite.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'documentsite.wsgi.application'


# Database
# https://docs.djangoproject.com/en/1.9/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}


# Password validation
# https://docs.djangoproject.com/en/1.9/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/1.9/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_L10N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/1.9/howto/static-files/

STATIC_URL = '/static/'
```
<i>DEBUG</i>: is a boolean that sets/unsets the project's debug mode. If set, Django displays a details error pages on uncaught exceptions thrown by an application. It is set by default. 

<i>ALLOWED_HOSTS</i>: is only used when the project is moved to production but not when debugging (i.e. when DEBUG=TRUE) or when running tests. 

When a project is moved to production, set DEBUG=FALSE and add the domain/host name to ALLOWED_HOSTS to allow the domain to serve the Django site. 

<i>INSTALLED_APPS</i>: specifies Django which applications are active for the site.

```python
INSTALLED_APPS = [
    'django.contrib.admin',             # administration site
    'django.contrib.auth',              # authentication framework
    'django.contrib.contenttypes',      # content types framework
    'django.contrib.sessions',          # sessions framework
    'django.contrib.messages',          # messaging framework
    'django.contrib.staticfiles',       # static files management framework
]
```

<i>MIDDLEWARE_CLASSES</i>: specifies middlewares to be executed in a tuple.

```python
MIDDLEWARE_CLASSES = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.auth.middleware.SessionAuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]
```
<i>ROOT_URLCONF</i>: specifies the Python module the location where root URL patterns of the application are defined

<i>DATABASES</i>: contains the settings for all the databases used in the project in a dictionary. It MUST contain a <i>default</i> database. The default configuration uses SQLite database as a default database.

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),
    }
}
```
<i>LANGUAGE_CODE</i>: specifies the default language code for this Django site.

To create the tables in the database, run the <i>migrate</i> management command:

> (vir_env) droid@droidserver:~/onGit/Django/documentsite$ python manage.py migrate

    Operations to perform:
      Apply all migrations: sessions, admin, contenttypes, auth
    Running migrations:
      Rendering model states... DONE
      Applying contenttypes.0001_initial... OK
      Applying auth.0001_initial... OK
      Applying admin.0001_initial... OK
      Applying admin.0002_logentry_remove_auto_add... OK
      Applying contenttypes.0002_remove_content_type_name... OK
      Applying auth.0002_alter_permission_name_max_length... OK
      Applying auth.0003_alter_user_email_max_length... OK
      Applying auth.0004_alter_user_username_opts... OK
      Applying auth.0005_alter_user_last_login_null... OK
      Applying auth.0006_require_contenttypes_0002... OK
      Applying auth.0007_alter_validators_add_error_messages... OK
      Applying sessions.0001_initial... OK

NOTE:  When the virtual environment is active, python in the command line refers to the version of python used when creating the virtual environment.



### Start Development Server

Django comes with a lightweight web server. It can be used to quickly run and test the app in the development phase. It checks for changes in the code and reloads the updated code. However, if new files are added to the project, the server has to be manually restarted.

To start the development server:

> (vir_env) droid@droidserver:~/onGit/Django/documentsite$ python manage.py runserver

    Performing system checks...
    
    System check identified no issues (0 silenced).
    February 04, 2016 - 17:34:43
    Django version 1.9.2, using settings 'documentsite.settings'
    Starting development server at http://127.0.0.1:8000/
    Quit the server with CONTROL-C.

Requesting 127.0.0.1:8000 in the browser    

    Not Found: /
    [04/Feb/2016 17:39:31] "GET / HTTP/1.1" 200 1767
    Not Found: /favicon.ico
    [04/Feb/2016 17:39:32] "GET /favicon.ico HTTP/1.1" 404 1942

for subsequent requests

    Not Found: /
    [04/Feb/2016 17:43:03] "GET / HTTP/1.1" 200 1767

Opening the app in the browser:

<img src="https://github.com/gruprog/Django-Examples/blob/master/documentsite/_misc/browser_snapshot.png"/>

<i>Providing custom host and port</i>

> (vir_env) droid@droidserver:~/onGit/Django/documentsite$ python manage.py runserver 127.0.0.1:8999

<i>Loading settings</i>

Settings for an environment can be saved in its own separate file and loaded as per the environment.

> (vir_env) droid@droidserver:~/onGit/Django/documentsite$ python manage.py runserver 127.0.0.1:8999 --settings=documentsite.settings

### Deploying in Production Environment

To deploy an application in a production environment, it should be run as a <b>Web Server Gateway Interface (WSGI)</b> application deployed on a real web server such as Apache, Gunicorn or uWSGI.

https://docs.djangoproject.com/en/1.9/howto/deployment/

### Creating an application

> $ (vir_env) droid@droidserver:~/onGit/Django/documentsite$ python manage.py startapp docs

> $ (vir_env) droid@droidserver:~/onGit/Django$ ls documentsite

    db.sqlite3  docs  documentsite  manage.py  _misc  README.md
    
> $ (vir_env) droid@droidserver:~/onGit/Django$ ls documentsite/docs

    admin.py  apps.py  __init__.py  migrations  models.py  tests.py  views.py

<img src="https://github.com/gruprog/Django-Examples/blob/master/documentsite/_misc/creating_docs_application.png"/>

### Application Structure

<b> Generated Files </b>

<i>documentsite/docs/migrations/</i>: is the directory that holds database migrations of the application. Django keeps track of model changes using migrations and synchronizes the database accordingly. 

<i>documentsite/docs/admin.py</i>: is the file where models are registered to include them into the Django administration site, the usage of which is optional.

<i>documentsite/docs/models.py</i>: a MUST TO HAVE file that constitutes the data models of the application. It could also be left empty.

<i>documentsite/docs/tests.py</i>: is where the tests of the application should be added

<i>documentsite/docs/views.py</i>: contains the application logic. Each web request is routed to an appropriate view which receives the HTTP request, processes it, and returns a response. 


